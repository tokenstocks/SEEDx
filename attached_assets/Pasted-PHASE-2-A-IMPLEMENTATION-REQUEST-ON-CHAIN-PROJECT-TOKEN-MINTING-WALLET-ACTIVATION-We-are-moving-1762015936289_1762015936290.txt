PHASE 2-A IMPLEMENTATION REQUEST ‚Äî ON-CHAIN PROJECT TOKEN MINTING & WALLET ACTIVATION

We are moving from cosmetic Stellar integration to real on-chain functionality.
Build the following for testnet only using the existing stellarConfig.ts and hybrid wallet structure.

1Ô∏è‚É£ Account Activation Flow

Purpose: Every project and user wallet should exist as a funded account on the Stellar testnet.

Implement server/lib/stellarAccount.ts:

createAndFundAccount(publicKey, startingBalance = "2")

Uses the Admin wallet as the funding source.

Submits a CreateAccount operation.

Returns { txHash, success: true/false }.

Handle ‚Äúalready exists‚Äù gracefully (don‚Äôt fail).

Extend registration flow:

After wallet keypair creation, call createAndFundAccount to activate the account.

Extend project creation flow:

After issuer/distribution keypair generation, call createAndFundAccount for both.

2Ô∏è‚É£ Project Token Minting

Purpose: When an admin creates a project, automatically mint its asset on Stellar.

Implement server/lib/stellarToken.ts:

createProjectToken({ projectId, assetCode, issuerKeys, distributionKeys })

Create a trustline: distribution ‚Üí issuer.

Send custom asset from issuer ‚Üí distribution.

Lock issuer account after minting (optional for now).

Store and return TX hashes for audit.

Update /api/admin/projects POST:

After creating project in DB, call createProjectToken.

Save TX hashes to projects table (stellarIssuerTx, stellarMintTx fields).

3Ô∏è‚É£ Transaction Recording

Purpose: Preserve full audit trail.

Extend projectTokenLedger to include:

action: "create" | "mint"

stellarTransactionHash

notes

Every on-chain operation should append a ledger entry.

4Ô∏è‚É£ Verification Endpoint

Add GET /api/setup/verify-onchain

Checks for each project:

Issuer & distribution accounts exist on Stellar (via Horizon)

Trustline established

Token visible in Horizon response

Returns summary of all projects and statuses.

5Ô∏è‚É£ Testing & Safety

Use only https://horizon-testnet.stellar.org.

Do not touch mainnet yet.

Include robust error handling and logging for Horizon API calls.

Add fallback so if Horizon API fails, system still creates DB entries but marks onChainSynced: false.

Expected Outcomes

‚úÖ Project creation now creates real on-chain Stellar assets
‚úÖ User & project wallets exist as active accounts on the testnet
‚úÖ All actions are auditable in projectTokenLedger
‚úÖ Admin can confirm everything using /api/setup/verify-onchain

Deliverables

server/lib/stellarAccount.ts

server/lib/stellarToken.ts

Updated /api/admin/projects route

GET /api/setup/verify-onchain

Documentation updates in replit.md

Let‚Äôs proceed carefully on testnet.
Once this is verified, we‚Äôll move to Phase 2-B (user trustlines + token distribution during investment).

üí° Assessment of This Step

This milestone:

Activates the full Stellar testnet pipeline.

Keeps your system modular (stellarAccount + stellarToken libs).

Leaves room for LP and investor wallet logic later.

Is testnet-only, so zero risk to production assets.

Once this is done, we‚Äôll have real tokens existing on Stellar and can confirm them via Stellar Expert.